1.概述
 代码工程：git://xxxxxxxx

语音识别服务目前主要对接天猫精灵与百度DuerOS（以下简称智能音箱），借力两大平台在语音识别上的技术优势，为用户提供特定场景下，通过天猫精灵或小度音箱对云威智能设备进行智能语音控制。

用户通过智能音箱接入到云威平台（以下简称平台），在经过登录授权和设备发现流程后，平台返回用户绑定的设备列表并在智能音箱APP里显示。用户通过智能音箱发起设备控制指令后，智能音箱云平台解析出用户意图，以其平台智能家居协议调起对应的云威智能家居技能。

语音识别服务接收到智能音箱平台的技能回调后，平台接入模块识别出对应的平台，通过协议解析模块解析出设备发现、设备控制、状态查询三类请求，通过设备模块、家庭模块与设备控制模块调用用户中心、设备中心、家庭管理等服务获取到用户信息和其绑定是设备列表，进行权限校验后，调用设备控制模块生成设备发现、设备控制、状态查询指令，并返回对应状态给智能音箱平台。

2.逻辑架构设计图
主要模块说明如下：
接入层网关：智能音箱平台所有的回调请求均通过API网关反向代理到语音识别服务。
DuerOS/AliGenie平台接入模块：平台接入模块在接收到请求后通过协议解析层解析技能回调数据，并进行会话控制与权限校验后转入对应的平台接入模块，处理设备发现、设备控制、状态查询三类请求与响应，并接受下游设备、家庭、用户等模块在接收到设备、家庭等事件时的回调。
AIUI接入模块：负责科大讯飞AIUI平台的接入接口对接，主要实现接口鉴权、语音识别与语义解析结果的接收与响应，根据与科大讯飞技术沟通结果，采用语音后处理方案接口对接。
设备模块：负责用户设备列表的获取以及处理设备信息更新等事件的平台通知业务。
用户模块：负责用户信息维护以及用户相关事件的平台通知业务。
家庭模块：负责家庭信息的维护以及家庭、家庭成员等事件发生后的平台通知业务。
设备控制：负责处理平台接入模块的设备控制业务，生成通用的设备控制指令，对接设备中心，发起设备控制，并在设备控制响应后通知平台接入模块。
AIUI语音交互模块：负责科大讯飞AIUI语义结果的处理，将意图转换为设备控制请求，实现语音智能控制。按照技能标识进行分模块处理，便于后续技能扩展，特别是后续增加自定义技能。

3.设计说明
      语音识别服务在接收到设备控制请求时，需要解析出对应的控制指令并响应给智能音箱平台，整个设备控制模块需要无阻塞的响应大量的控制请求，所以设备控制模块采用了协程池的设计方案。主要如下：

设备控制模块以协程池的形式运行，平台接入模块通过协议解析层解析出对应的控制请求后，通过Channel向设备控制模块发送指令控制参数，指令解析模块收到控制参数后生成控制指令向设备中心发起设备控制请求。
科大讯飞AIUI平台对接，需要实现语义结果解析，意图转换为设备控制请求，以实现语音智能控制。上下文多轮语音交互由科大讯飞平台完成，小威云仅处理最终的语义意图。
服务组件设计为无状态，可横向水平扩展，通过分布式微服务治理机制接入系统集群中；
.....
4.流程图
示例-OTA升级流程（强调业务逻辑采用SDL流程图）

5.数据库设计（如有多个数据库或多种数据库，则分开多个章节描述）
数据库名称：sp_ocs_customer_service
数据库ER图（采用SQLyog设计工具，在数据库中更新好全部字段说明，截图附在下面，设计文件附件上传）：

6.接口设计
接口框架协议与规范说明（如果是同一套，可直接复用说明即可）：
重点描述安全机制、公共参数定义、请求与响应净荷定义、错误码定义等。


7.部署设计（非必选项，复杂部署方案则需要说明）


8.总结与优化建议
    存在XXXX问题，建议采用什么方案优化解决
